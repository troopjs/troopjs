<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * @license MIT http://troopjs.mit-license.org/
 */
define([
	&quot;../emitter/composition&quot;,
	&quot;../config&quot;,
	&quot;../component/executor&quot;,
	&quot;poly/array&quot;,
	&quot;poly/object&quot;
], function (Emitter, config, executor) {
	&quot;use strict&quot;;

<span id='core-registry-emitter'>	/**
</span>	 * A light weight implementation to register key/value pairs by key and index
	 * @class core.registry.emitter
	 * @extend core.emitter.composition
	 */

	var LENGTH = &quot;length&quot;;
	var INDEX = &quot;index&quot;;
	var OBJECT_TOSTRING = Object.prototype.toString;
	var TOSTRING_REGEXP = &quot;[object RegExp]&quot;;
	var SIG_REGISTER = config.signal.register;
	var SIG_UNREGISTER = config.signal.unregister;
	var EXECUTOR = config.emitter.executor;

<span id='core-registry-emitter-event-sig-register'>	/**
</span>	 * Register signal
	 * @event sig/register
	 * @localdoc Triggered when something is registered via {@link #register}.
	 * @since 3.0
	 * @param {String} key
	 * @param {*} value
	 */

<span id='core-registry-emitter-event-sig-unregister'>	/**
</span>	 * Un-register signal
	 * @event sig/unregister
	 * @localdoc Triggered when something is un-registered via {@link #unregister}.
	 * @since 3.0
	 * @param {String} key
	 * @param {*} value
	 */

<span id='core-registry-emitter-method-constructor'>	/**
</span>	 * @method constructor
	 * @inheritdoc
	 */
	return Emitter.extend(function () {
<span id='core-registry-emitter-property-this[INDEX]'>		/**
</span>		 * Registry index
		 * @private
		 * @readonly
		 */
		this[INDEX] = {};
	}, (function (key, value) {
		var me = this;
		me[key] = value;
		return me;
	}).call({
		&quot;displayName&quot;: &quot;core/registry/emitter&quot;,

<span id='core-registry-emitter-method-get'>		/**
</span>		 * Gets value by key
		 * @param {String|RegExp} [key] key to filter by
		 *  - If `String` get value exactly registered for key.
		 *  - If `RegExp` get value where key matches.
		 *  - If not provided all values registered are returned
		 * @return {*|*[]} result(s)
		 */
		&quot;get&quot;: function (key) {
			var index = this[INDEX];
			var result;

			if (arguments[LENGTH] === 0) {
				result = Object
					.keys(index)
					.map(function (_key) {
						return index[_key];
					});
			}
			else if (OBJECT_TOSTRING.call(key) === TOSTRING_REGEXP) {
				result = Object
					.keys(index)
					.filter(function (_key) {
						return key.test(_key);
					}).map(function (_key) {
						return index[_key];
					});
			}
			else {
				result = index[key];
			}

			return result;
		},

<span id='core-registry-emitter-method-register'>		/**
</span>		 * Registers value with key
		 * @param {String} key Key
		 * @param {*} value Value
		 * @fires sig/register
		 * @return {*} value registered
		 */
		&quot;register&quot;: function (key, value) {
			var me = this;
			var index = me[INDEX];

			if (index[key] !== value) {

				if (index.hasOwnProperty(key)) {
					me.unregister(key);
				}

				me.emit(SIG_REGISTER, key, index[key] = value);
			}

			return value;
		},

<span id='core-registry-emitter-method-unregister'>		/**
</span>		 * Un-registers key
		 * @param {String} key Key
		 * @fires sig/unregister
		 * @return {*} value unregistered
		 */
		&quot;unregister&quot;: function (key) {
			var me = this;
			var index = me[INDEX];
			var value;

			if (index.hasOwnProperty(key)) {

				value = index[key];

				if (delete index[key]) {
					me.emit(SIG_UNREGISTER, key, value);
				}
			}

			return value;
		}
	}, EXECUTOR, executor));
});
</pre>
</body>
</html>
