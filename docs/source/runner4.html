<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * @license MIT http://troopjs.mit-license.org/
 */
define([
	&quot;mu-selector-set/main&quot;,
	&quot;jquery&quot;,
	&quot;poly/array&quot;
], function (SelectorSet, $) {
	&quot;use strict&quot;;

<span id='dom-runner'>	/**
</span>	 * @class dom.runner
	 * @mixin Function
	 * @private
	 * @static
	 * @alias feature.runner
	 */

	var UNDEFINED;
	var FALSE = false;
	var LEFT_BUTTON = 0;

	function map (match) {
		return match[1];
	}

	// Use `$.find.matchesSelector` for wider browser support
	SelectorSet.prototype.matchesSelector = $.find.matchesSelector;

<span id='dom-runner-method-constructor'>	/**
</span>	 * @method constructor
	 * @inheritdoc core.event.runner#constructor
	 * @localdoc
	 * - Executes handlers synchronously passing each handler `args`.
	 * - If a handler returns `false` no more handlers will be executed.
	 * - If a handler stops propagation no more handlers will be executed.
	 * @return {*} Result from last handler
	 */
	return function sequence(event, handlers, args) {

		var result = UNDEFINED;
		var direct = handlers.direct;
		var delegated = handlers.delegated;
		var reduce = function (result, handler) {
			// If immediate propagation is stopped we should just return last result
			if ($event.isImmediatePropagationStopped()) {
				return result;
			}

			// If the previous handler return false we should stopPropagation and preventDefault
			if (result === FALSE) {
				$event.stopPropagation();
				$event.preventDefault();
			}

			return handler.run(args);
		};

		var $event = args[0];
		var $delegate = $event.delegateTarget;
		var $target = $event.target;
		var $document = $target.ownerDocument;
		var $notClick = $event.type !== &quot;click&quot;;

		// Bubble the event up the dom if
		// ... this is not a black-holed element (jQuery #13180)
		// ... and this is the left button or it's a not a click event (jQuery #3861)
		var $bubble = $target.nodeType !== UNDEFINED &amp;&amp; ($event.button === LEFT_BUTTON || $notClick);

		// Loop ...
		do {
			// Don't process clicks on disabled elements (jQuery #6911, #8165, #11382, #11764)
			if ($target.disabled !== true || $notClick) {
				// Run delegated handlers which match this element
				result = delegated
					.matches($event.currentTarget = $target)
					.map(map)
					.reduce(reduce, result);
			}

			// Bubble if ...
			$bubble = $bubble
				// ... we were not told to stop propagation
				&amp;&amp; !$event.isPropagationStopped()
				// ... we are not at the delegate element
				&amp;&amp; $target !== $delegate
				// ... we have a parent node
				&amp;&amp; ($target = $target.parentNode) !== null
				// ... the new target is not the document
				&amp;&amp; $target !== $document;
		}
		// ... while we are still bubbling
		while ($bubble);

		// Run all the direct (non-delegated) handlers of the root element
		if (result !== FALSE) {
			result = direct.reduce(reduce, result);
		}

		return result;
	}
});</pre>
</body>
</html>
