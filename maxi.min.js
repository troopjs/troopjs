/**
 *   ____ .     ____  ____  ____    ____.
 *   \   (/_\___\  (__\  (__\  (\___\  (/
 *   / ._/  ( . _   \  . /   . /  . _   \_
 * _/    ___/   /____ /  \_ /  \_    ____/
 * \   _/ \____/   \____________/   /
 *  \_t:_____r:_______o:____o:___p:/ [ troopjs - 3.0.0-pr.2+fa7fcdb ]
 *
 * @license http://troopjs.mit-license.org/ Â© Mikael Karon
 */

define("troopjs/version",[],"3.0.0-pr.2+fa7fcdb"),define("troopjs-util/merge",["poly/object"],function(){"use strict";var a,b=null,c=Array.prototype,d=c.concat,e=Object.prototype,f=e.toString,g=f.call(e),h=f.call(c),i="length";return function j(c){var e,k,l,m,n,o,p,q,r,s,t=this;if(t!==a&&t!==b)for(l=0,n=arguments[i];n>l;l++)if((c=arguments[l])!==a&&c!==b)for(k=Object.keys(c),m=0,o=k[i];o>m;m++)e=k[m],p=c[e],q=t[e],e in t?(r=f.call(p),s=f.call(q),s===g&&r===g?j.call(q,p):t[e]=s===h&&r===h?d.call(q,p):p):t[e]=p;return t}}),define("troopjs-compose/mixin/config",["module","troopjs-util/merge"],function(a,b){"use strict";return b.call({pragmas:[]},a.config())}),define("troopjs-compose/mixin/decorator",["poly/object"],function(){"use strict";return function(a){Object.defineProperties(this,{decorate:{value:a}})}}),define("troopjs-util/unique",[],function(){"use strict";var a="length";return function(b){var c,d,e,f,g=this,h=g[a];if(b)a:for(d=f=0;h>d;d++){for(c=g[d],e=0;d>e;e++)if(b.call(g,c,[e])===!0)continue a;g[f++]=c}else a:for(d=f=0;h>d;d++){for(c=g[d],e=0;d>e;e++)if(c===g[e])continue a;g[f++]=c}return g[a]=f,f}}),define("troopjs-util/getargs",[],function(){"use strict";var a,b=String.prototype.substring,c=String.prototype.slice,d=/^(["']).*\1$/,e=/^(?:false|true)$/i,f=/^true$/i,g=/^\d+$/;return function(){function h(h,i){if(h!==i){var j=b.call(o,h,i);d.test(j)?j=c.call(j,1,-1):e.test(j)?j=f.test(j):g.test(j)&&(j=+j),p.push(j),m!==a&&(p[m]=j,m=a)}}var i,j,k,l,m,n,o=this,p=[],q=!1;for(k=i=j=0,l=o.length;l>k;k++)switch(n=o.charAt(k)){case'"':case"'":q===n?(q=!1,j=k+1):q===!1&&(q=n,i=j=k);break;case" ":case"	":if(q){j=k+1;break}i===j&&(i=j=k+1);break;case"=":if(q){j=k+1;break}i!==j&&(m=b.call(o,i,j),d.test(m)&&(m=c.call(m,1,-1))),i=k+1;break;case",":if(q){j=k+1;break}h(i,j),i=j=k+1;break;default:j=k+1}return h(i,j),p}}),define("troopjs-compose/mixin/factory",["./config","./decorator","troopjs-util/unique","troopjs-util/getargs","poly/object"],function(a,b,c,d){"use strict";function e(){return f.apply(this,arguments)()}function f(){var a=[this];return l.apply(a,arguments),h.apply(null,a)}function g(){var a=this,b=a[i];return p in b?b[p]:n.call(a)}function h(){function a(){var b,c=this instanceof a?this:Object.create(Z),d=arguments;for(Object.defineProperty(c,u,{value:a}),b=0;F>b;b++)d=X[b].apply(c,d)||d;return c}var h,k,p,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=[],V=arguments,W=V[q],X=[],Y=U[B]=[],Z={},$={},_={};for(K=0;W>K;K++){if(p=V[K],typeof p===o){if(v in p?l.apply(X,p[v]):l.call(X,p),w in p&&m.apply(U,p[w]),p===p[i][u])continue;p=p[i]}for(I=Object.getOwnPropertyNames(p),L=0,J=I[q];J>L;L++){for(G=H=I[L],M=0;M<D[q]&&(N=D[M],(G=G.replace(N.pattern,N.replace))===H);M++);if(R=E.exec(G)){if(h={},h[x]=O=R[1],(Q=R[2])&&(h[A]=Q),h[C]=O+(Q?"/"+Q:""),h[z]=d.call(R[3]||""),"[object Function]"!==n.call(h[y]=p[H]))continue;m.call(U,h)}else T=Object.getOwnPropertyDescriptor(p,H),S=T[y],$[G]=S instanceof b?S[t]($[G]||{enumerable:!0,configurable:!0,writable:!0},G,$):T}}for(Object.defineProperties(Z,$),F=c.call(X),k=c.call(U),K=0;k>K;K++)h=U[K],O=h[x],Q=h[A],G=h[C],O=O in U?U[O]:U[Y[Y[q]]=O]=[],Q&&(P=B in O?O[B]:O[B]=[],Q=Q in O?O[Q]:O[P[P[q]]=Q]=U[G]=[],Q[Q[q]]=h),O[O[q]]=h;return _[i]={value:Z},_[v]={value:X},_[w]={value:U},_[j]={value:g},_[r]={value:f},_[s]={value:e},Object.defineProperties(a,_),a}var i="prototype",j="toString",k=Array[i],l=k.push,m=k.unshift,n=Object[i][j],o="function",p="displayName",q="length",r="extend",s="create",t="decorate",u="constructor",v="constructors",w="specials",x="group",y="value",z="args",A="type",B="types",C="name",D=a.pragmas,E=/^(.*?)(?:\/([^\(]+))?\((.*)\)$/;return Object.defineProperty(h,s,{value:function(){return h.apply(null,arguments)()}}),h}),define("troopjs-log/sink/methods",[],function(){return["assert","debug","dir","error","info","log","time","timeEnd","trace","warn"]}),define("troopjs-log/sink/console",["./methods","poly/array","poly/function"],function(a){"use strict";return function(b){var c=this,d=function(){};return a.forEach(function(a){c[a]=this.call(b[a]||d,b)},Function.prototype.bind),c}.call({},(this||window).console||{})}),define("troopjs-log/logger",["./sink/console"],function(a){"use strict";return a}),define("troopjs-core/mixin/base",["troopjs-compose/mixin/factory","troopjs-log/logger"],function(a,b){var c=0,d="instanceCount";return a(function(){this[d]=++c},b,{instanceCount:c,displayName:"core/mixin/base",toString:function(){var a=this;return a.displayName+"@"+a[d]}})}),define("troopjs-core/event/runner/sequence",["when"],function(a){"use strict";var b,c="head",d="next",e="callback",f="context";return function(g,h,i){var j,k=[],l=0,m=[],n=0;for(j=h[c];j!==b;j=j[d])m[n++]=j;n=0;var o=function(c,d){var g;return d!==!0&&(k[l++]=c),(g=m[n++])!==b?a(g[e].apply(g[f],i),o):a.resolve(k)};return o(i,!0)}}),define("troopjs-core/event/emitter",["../mixin/base","./runner/sequence"],function(a,b){"use strict";var c,d=Array.prototype.slice,e=Object.prototype.toString,f="[object String]",g="handlers",h="length",i="type",j="runner",k="context",l="callback",m="data",n="head",o="tail",p="next";return a.extend(function(){this[g]=[]},{displayName:"core/event/emitter",on:function(a,b,d,e){var f,j,q=this;if(d===c)throw new Error("no callback provided");return(f=q[g][a])!==c?(j={},j[l]=d,j[k]=b,j[m]=e,f[o]=o in f?f[o][p]=j:f[n]=j):(f=q[g],f=f[f[h]]=f[a]={},f[i]=a,f[n]=f[o]=j={},j[l]=d,j[k]=b,j[m]=e),q},off:function(a,b,d){var e,f,h,i,j=this;if((e=j[g][a])!==c&&n in e){for(f=e[n];f!==c;f=f[p])(b&&f[k]!==b||d&&f[l]!==d)&&(h?i=i[p]=f:h=i=f);h&&i?(e[n]=h,e[o]=i,delete i[p]):(delete e[n],delete e[o])}return j},emit:function(a){var k,l,m=this,n=a;if(e.call(a)===f)a={},a[j]=l=b,a[i]=n;else{if(!(i in a))throw Error("first argument has to be of type '"+f+"' or have a '"+i+"' property");a[j]=l=a[j]||b,n=a[i]}return(k=m[g][n])===c&&(k=m[g],k=k[k[h]]=k[n]={},k[i]=n),l.call(m,a,k,d.call(arguments,1))}})}),define("troopjs-core/component/runner/sequence",["poly/array"],function(){"use strict";var a,b="head",c="next",d="callback",e="context";return function(f,g,h){var i,j,k=f[e],l=f[d],m=[],n=0;for(i=g[b];i!==a;i=i[c])(k===a||i[e]===k)&&(l&&i[d]!==l||(m[n++]=i));return m.reduce(function(b,c){return b!==a&&(j=b),j!==!1?c[d].apply(c[e],h):j},a)}}),define("troopjs-core/registry/component",["../mixin/base","poly/array"],function(a){"use strict";var b,c="length",d="index",e="key",f="value",g="index_key",h="index_pos",i=Object.prototype.toString,j="[object String]";return a.extend(function(){this[g]={},this[h]=[]},{displayName:"core/registry/component",access:function(a,k){var l,m,n=this[g],o=this[h];if(0===(m=arguments[c]))l=o.map(function(a){return a[f]});else if(l=("number"==typeof a?o:n)[a],1===m)l=l!==b?l[f]:b;else if(l!==b)l=l[f]=k;else{if(i.call(a)!==j)throw Error("key has to be of type String");l={},l=n[l[e]=a]=o[l[d]=o[c]]=l,l=l[f]=k}return l},remove:function(a){var f,i=this,j=i[g],k=i[h];0===arguments[c]?(i[g]={},i[h]=[]):(f=j[a])!==b&&(delete j[f[e]],delete k[f[d]])},compact:function(){}})}),define("troopjs-core/pubsub/runner/pattern",[],function(){return/^(?:initi|fin)alized?$/}),define("troopjs-core/pubsub/runner/pipeline",["./pattern","when"],function(a,b){"use strict";var c,d=Object.prototype.toString,e="[object Arguments]",f="[object Array]",g="context",h="callback",i="head",j="next",k="phase",l="memory";return function(m,n,o){var p,q=m[g],r=m[h],s=[],t=0;for(p=n[i];p!==c;p=p[j])(q===c||p[g]===q)&&(r===c||p[h]===r)&&(s[t++]=p);t=0;var u=function(i){var j,m,p;for(i!==c&&i!==o&&(o=(p=d.call(i))===f||p===e?i:[i]);(m=s[t++])&&(j=m[g])&&a.test(j[k]););return m!==c?b(m[h].apply(j,o),u):b.resolve(n[l]=o)};return u(o)}}),define("troopjs-compose/decorator/from",["../mixin/decorator"],function(a){"use strict";var b,c="value",d="prototype";return function(e,f){return"string"==typeof e&&(f=e,e=b),new a(function(a,b,g){return b=f||b,a[c]=e?e[d][b]:g[b][c],a})}}),define("troopjs-core/pubsub/hub",["../event/emitter","./runner/pipeline","troopjs-compose/decorator/from"],function(a,b,c){"use strict";var d,e="memory",f="handlers",g="runner",h="type";return a.create({displayName:"core/pubsub/hub",subscribe:c("on"),unsubscribe:c("off"),publish:function(a){var c=this,d={};return d[h]=a,d[g]=b,arguments[0]=d,c.emit.apply(c,arguments)},peek:function(a,b){var c;return(c=this[f][a])!==d&&e in c?c[e]:b}})}),define("troopjs-core/component/registry",["../registry/component","../pubsub/hub"],function(a,b){"use strict";return a.create(function(){var a=this;a.access(b.toString(),b),a.access(a.toString(),a)},{displayName:"core/component/registry"})}),define("troopjs-core/task/registry",["../registry/component","../component/registry"],function(a,b){"use strict";return a.create(function(){var a=this;b.access(a.toString(),a)},{displayName:"core/task/registry"})}),define("troopjs-compose/decorator/around",["../mixin/decorator"],function(a){"use strict";var b="value",c=function(){};return function(d){return new a(function(a){return a[b]=d(a[b]||c),a})}}),define("troopjs-core/component/base",["../event/emitter","./runner/sequence","troopjs-compose/mixin/config","./registry","../task/registry","troopjs-util/merge","troopjs-compose/decorator/around","when","poly/array"],function(a,b,c,d,e,f,g,h){"use strict";var i,j=!1,k=Array.prototype,l=k.push,m="configuration",n="runner",o="handlers",p="head",q="tail",r="context",s="name",t="type",u="value",v="phase",w="task",x="stop",y="initialize",z="started",A="finalized",B="finished",C="sig",D=C+"/setup",E=C+"/add",F=C+"/remove",G=C+"/teardown",H="on",I=new RegExp("^"+C+"/(.+)");return c.pragmas.push({pattern:/^(?:sig|on)\/.+/,replace:"$&()"}),a.extend(function(){var a=this,b=a.constructor.specials[C]||k;b.forEach(function(b){a.on(b[s],b[u])}),a[m]={}},{displayName:"core/component/base","sig/initialize":function(){var a=this;return d.access(a.toString(),a),h.map(a.constructor.specials[H]||k,function(b){return a.on(b[t],b[u])})},"sig/finalize":function(){var a=this;return d.remove(a.toString()),h.map(a[o].reverse(),function(b){return a.off(b[t])})},"sig/task":function(a){var b=a[s]+"@"+a[z];return e.access(b,a.ensure(function(){e.remove(b)}))},configure:function(){return f.apply(this[m],arguments)},on:g(function(a){return function(c,d,e){var f,g,h,k=this;return I.test(c)||((g=k[o][c])===i&&(g={},g[t]=c),f={},f[n]=b,p in g||(f[t]=D,h=k.emit(f,g,c,d,e)),h!==j&&(f[t]=E,h=k.emit(f,g,c,d,e)),h!==j&&k[o][c]!==g&&l.call(k[o],k[o][c]=g)),h!==j?a.call(k,c,k,d,e):k}}),off:g(function(a){return function(c,d){var e,f,g,h=this;return I.test(c)||((f=h[o][c])===i&&(f={},f[t]=c),e={},e[n]=b,e[t]=F,g=h.emit(e,f,c,d),g!==j&&f[p]===f[q]&&(e[t]=G,g=h.emit(e,f,c,d)),g!==j&&h[o][c]!==f&&l.call(h[o],h[o][c]=f)),g!==j?a.call(h,c,h,d):h}}),signal:function(a){var b=this;return arguments[0]="sig/"+a,b.emit.apply(b,arguments)},start:function(a){var b,c=this,d=c.signal;return(b=c[v])!==i&&b!==A?h.resolve(i):(a=[c[v]=y],l.apply(a,arguments),d.apply(c,a).then(function(b){return a[0]=c[v]="start",d.apply(c,a).then(function(a){return c[v]=z,k.concat(b,a)})}))},stop:function(a){var b=this,c=b.signal;return b[v]!==z?h.resolve(i):(a=[b[v]=x],l.apply(a,arguments),c.apply(b,a).then(function(d){return a[0]=b[v]="finalize",c.apply(b,a).then(function(a){return b[v]=A,k.concat(d,a)})}))},task:function(a,b){var c=this,d=h.promise(a).ensure(function(){d[B]=new Date});return d[r]=c,d[z]=new Date,d[s]=b||w,c.signal(w,d).yield(d)}})}),define("troopjs-core/component/runner/pipeline",["when"],function(a){"use strict";var b,c=Object.prototype.toString,d="[object Arguments]",e="[object Array]",f="context",g="callback",h="head",i="next";return function(j,k,l){var m,n=j[f],o=j[g],p=[],q=0;for(m=k[h];m!==b;m=m[i])(n===b||m[f]===n)&&(o&&m[g]!==o||(p[q++]=m));q=0;var r=function(h){var i,j;return h!==b&&h!==l&&(l=(j=c.call(h))===e||j===d?h:[h]),(i=p[q++])!==b?a(i[g].apply(i[f],l),r):a.resolve(l)};return r(l)}}),define("troopjs-core/component/gadget",["./base","./runner/pipeline","troopjs-compose/mixin/config","when","../pubsub/hub"],function(a,b,c,d,e){"use strict";var f,g=null,h=Array.prototype,i="runner",j="context",k="callback",l="args",m="type",n="value",o="hub",p=new RegExp("^"+o+"/(.+)");return c.pragmas.push({pattern:/^hub(?:\:(memory))?\/(.+)/,replace:function(a,b,c){return o+'("'+c+'", '+!!b+")"}}),a.extend({displayName:"core/component/gadget","sig/initialize":function(){var a=this;return d.map(a.constructor.specials[o]||h,function(b){return a.subscribe(b[l][0],b[n])})},"sig/start":function(){var a=this,c={},e=a.constructor.specials[o]||h;return e=e.map(function(d){var e,f,g=d[l][0];return d[l][1]===!0&&(e=a.peek(g,c))!==c&&(f={},f[m]=o+"/"+g,f[i]=b,f[j]=a,f[k]=d[n],f=[f].concat(e)),f}).filter(function(a){return a!==f}),d.map(e,function(b){return a.emit.apply(a,b)})},"sig/add":function(a,b,c){var d,f=this;(d=p.exec(b))!==g&&e.subscribe(d[1],f,c)},"sig/remove":function(a,b,c){var d,f=this;(d=p.exec(b))!==g&&e.unsubscribe(d[1],f,c)},"sig/task":function(a){return this.publish("task",a)},publish:function(){return e.publish.apply(e,arguments)},subscribe:function(a,b,c){return this.on(o+"/"+a,b,c)},unsubscribe:function(a,b){return this.off(o+"/"+a,b)},peek:function(a,b){return e.peek(a,b)}})}),define("troopjs-dom/css/selector",["troopjs-compose/mixin/factory"],function(a){"use strict";function b(){return[t]}function c(a){return[a.nodeName.toUpperCase()]}function d(a){var b,c;return(b=a.className)!==h&&("string"==typeof b?c=b.split(B):"object"==typeof b&&A in b&&(c=b[A].split(B))),c}function e(a){var b;return(b=a.id)!==h&&[b]}function f(a){var b=a[j],c=b,d=a.charAt(--b),e=!1;a:for(;b>=0;)switch(d){case s:if((d=a.charAt(--b))!==r&&!e){b+=2;break a}break;case y:e=(d=a.charAt(--b))!==r;break;case x:(e=(d=a.charAt(--b))===r)||(c=b+1);break;case u:case w:case v:(d=a.charAt(--b))&&d!==h&&d!==r&&d!==s&&!e&&(c=b+1);break;default:d=a.charAt(--b)}return a.substring(b,c)||t}function g(a,b){return a[z]-b[z]}var h,i=Array.prototype.slice,j="length",k="indexes",l="indexed",m="indexer",n="class",o="id",p="tag",q="universal",r="\\",s=" ",t="*",u="#",v=".",w=":",x="[",y="]",z="count",A="baseVal",B=/\s+/,C=a(function(){var a=this;a[k]=[],a[z]=0},{add:function(a,g){var r,s,w,x,y=this,A=y[k],B=f(a);switch(g=i.call(arguments),g[z]=y[z]++,B.charAt(0)){case u:x=o,s=e,B=B.substring(1);break;case v:x=n,s=d,B=B.substring(1);break;case t:x=q,s=b;break;default:x=p,s=c,B=B.toUpperCase()}return(w=A[x])!==h?r=w[l]:(w=A[x]=A[A[j]]={},w[m]=s,r=w[l]={}),B in r?r[B].push(g):r[B]=[g],y},matches:function(a,b){var c,d,e,f,i,n,o,p,q=this,r=q[k],s=r[j],t=[],u=0;if(!b)return t;for(;s--;)for(e=r[s],c=e[m],d=e[l],f=c(b),i=f[j];i--;)if((n=d[f[i]])!==h)for(p=n[j];p--;)o=n[p],a(b,o[0])&&(t[u++]=o);return t.sort(g)}});return C.tail=f,C}),define("troopjs-dom/component/runner/sequence",["../../css/selector","jquery","poly/array"],function(a,b){"use strict";var c,d="context",e="callback",f="data",g="head",h="next",i="selector",j="modified",k=b.find.matchesSelector;return function(b,l,m){var n,o,p=l[j],q=m[0];if((n=l[i])===c||n[j]!==p)for(n=l[i]=a(),n[j]=p,o=l[g];o!==c;o=o[h])n.add(o[f]||"*",o);return n.matches(k,q.target).reduce(function(a,b){if(q.isImmediatePropagationStopped())return a;a===!1&&(q.stopPropagation(),q.preventDefault());var c=b[1];return c[e].apply(c[d],m)},c)}}),define("troopjs-dom/loom/config",["module","troopjs-util/merge"],function(a,b){"use strict";return b.call({$warp:"$warp",$weft:"$weft",weave:"data-weave",unweave:"data-unweave",woven:"data-woven"},a.config())}),define("troopjs-util/defer",["when","poly/array"],function(a){"use strict";var b=Array.prototype.slice;return function(){var c=a.defer();return["resolve","reject","progress"].forEach(function(a){var c=this,d=c.resolver[a];c[a]=function(){d.apply(c,arguments)},c[a+"With"]=function(a){d.apply(a,b.call(arguments,1))}},c),c}}),define("troopjs-dom/loom/weave",["./config","require","when","jquery","troopjs-util/getargs","troopjs-util/defer","poly/array"],function(a,b,c,d,e,f){"use strict";function g(a){return a.filter(function(a){if("rejected"===a.state&&a.reason!==v)throw a.reason;return"fulfilled"===a.state}).map(function(a){return a.value})}var h,i=null,j=Array.prototype,k=j.map,l=j.push,m=j.shift,n="weave",o="woven",p="length",q=a.$warp,r=a.$weft,s=a[n],t=a[o],u=/[\s,]+/,v="cancel";return function(a){return a=arguments,c.all(k.call(this,function(j){for(var k,w,x,y=d(j),z=y.data(),A=z[q]||(z[q]=[]),B=[],C=y.attr(s)||"",D=/[\s,]*(((?:\w+!)?([\w\d_\/\.\-]+)(?:#[^(\s]+)?)(?:\(([^\)]+)\))?)/g,E=function(a){var b=[],c=[];a.forEach(function(a){c.push(a[r][n]),b.push(a[r][o])}),y.attr(t,function(a,c){return c=(c!==h?c.split(u):[]).concat(b).join(" "),c||null}).attr(s,function(a,b){var d=[];return b!==h&&(d=B.filter(function(a){return c.indexOf(a[n])<0}).map(function(a){return a[n]})),0===d[p]?null:d.join(" ")})};(w=D.exec(C))!==i;)x=w[4],k=[w[2],y.get(0),w[3]],k[n]=w[1],x!==h&&l.apply(k,e.call(x).map(function(a){return a in z?z[a]:a})),l.call(B,k);return c.settle(B.map(function(d){var e=c.defer(),g=e.resolver,h=e.promise,i=m.call(d);return h[n]=d[n],l.call(A,h),setTimeout(function(){b([i],function(b){var c,i;-1===A.indexOf(h)&&g.reject(v);try{c=b.apply(b,d),c[r]=h,h[o]=c.toString(),c.trigger?(e=f(),c.start(e),i=e.promise):i=c.start.apply(c,a),g.resolve(i.yield(c))}catch(j){g.reject(j)}},g.reject)},0),h})).then(g).tap(E)}))}}),define("troopjs-dom/loom/unweave",["./config","when","jquery","poly/array","troopjs-util/defer"],function(a,b,c,d){"use strict";function e(a){return a.filter(function(a){if("rejected"===a.state&&a.reason!==u)throw a.reason;return"fulfilled"===a.state}).map(function(a){return a.value})}var f,g=null,h=Array.prototype,i=h.map,j=h.push,k="weave",l="unweave",m="woven",n="length",o=a.$warp,p=a.$weft,q=a[k],r=a[m],s=a[l],t=/[\s,]+/,u="cancel";return function(a){return a=arguments,b.all(i.call(this,function(h){var i,l,u,v,w,x=c(h),y=x.data(),z=y[o]||(y[o]=[]),A=[],B=x.attr(s),C=[],D=/[\s,]*([\w_\/\.\-]+)(?:@(\d+))?/g,E=function(a){var b={},c=[];a.forEach(function(a){var d=a[p];b[d[m]]=1,c.push(d[k])}),x.attr(r,function(a,c){var d=[];return c!==f&&j.apply(d,c.split(t).filter(function(a){return!(a in b)})),0===d[n]?null:d.join(" ")}).attr(q,function(a,b){var d=(b!==f?b.split(t):[]).concat(c);return 0===d[n]?null:d.join(" ")})};if(x.removeAttr(s),B===f)j.apply(A,z),z[n]=0;else{for(;(i=D.exec(B))!==g;)j.call(C,"^"+i[1]+"@"+(i[2]||"\\d+")+"$");for(C=new RegExp(C.join("|")),v=w=0,u=z[n];u>v;v++)l=z[v],C.test(l[m])?j.call(A,l):z[w++]=l;z[n]=w}return b.settle(A).then(e).then(function(c){return b.map(c,function(b){var c,e;return b.trigger?(c=d(),b.stop(c),e=c.promise):e=b.stop.apply(b,a),e.yield(b)})}).tap(E)}))}}),define("troopjs-jquery/destroy",["jquery"],function(a){"use strict";var b="destroy";a.event.special[b]={noBubble:!0,trigger:function(){return!1},remove:function(b){var c=this;b&&b.handler.call(c,a.Event(b.type,{data:b.data,namespace:b.namespace,target:c}))}}}),define("troopjs-dom/component/widget",["troopjs-core/component/gadget","./runner/sequence","troopjs-compose/mixin/config","jquery","when","troopjs-util/merge","../loom/config","../loom/weave","../loom/unweave","troopjs-jquery/destroy"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){function b(b){var c=this;return arguments.length?e.all(o.call(arguments)).then(function(d){var f=d.shift();return e(typeof f===r?f.apply(c,d):b,function(b){return h.call(a.call(c[s],b).find(C))})}):a.call(c[s])}return b}function k(a,b){E.test(b)&&(a[t]=(new Date).getTime())}var l,m=null,n=Array.prototype,o=n.slice,p=n.push,q=d.fn.get,r="function",s="$element",t="modified",u="proxy",v="dom",w="args",x="name",y="value",z="type",A="runner",B="finalize",C="["+g.weave+"]",D="["+g.woven+"]",E=new RegExp("^"+v+"/(.+)");return c.pragmas.push({pattern:/^dom(?:\:([^\/]+))?\/(.+)/,replace:v+'/$2("$1")'}),a.extend(function(a,b){var c,e=this;if(a===l)throw new Error("No $element provided");if(a.jquery)(c=a.get)!==q&&(a=d(c.call(a,0)));else{if(!a.nodeType)throw new Error("Unsupported widget element");a=d(a)}e[s]=a,b!==l&&(e.displayName=b)},{displayName:"dom/component/widget","sig/initialize":function(){var a=this;return e.map(a.constructor.specials[v]||n,function(b){return a.on(b[x],b[y],b[w][0])})},"sig/setup":function(a,c){var d,e=this;(d=E.exec(c))!==m&&e[s].on(d[1],m,e,a[u]=function(){var a={};return a[z]=c,a[A]=b,a=[a],p.apply(a,arguments),e.emit.apply(e,a)})},"sig/add":k,"sig/remove":k,"sig/teardown":function(a,b){var c,d=this;(c=E.exec(b))!==m&&d[s].off(c[1],m,a[u])},"sig/task":function(a){this[s].trigger("task",[a])},"dom/destroy":function(){this.phase!==B&&i.call(this[s])},weave:function(){return h.apply(this[s].find(C),arguments)},unweave:function(){return i.apply(this[s].find(D),arguments)},before:j(d.fn.before),after:j(d.fn.after),html:j(d.fn.html),text:j(d.fn.text),append:j(d.fn.append),prepend:j(d.fn.prepend)})}),define("troopjs-dom/application/widget",["../component/widget","when"],function(a,b){"use strict";var c=Array.prototype.slice,d="components";return a.extend(function(){this[d]=c.call(arguments,2)},{displayName:"dom/application/widget","sig/initialize":function(){var a=arguments;return b.map(this[d],function(b){return b.signal("initialize",a)})},"sig/start":function(){var a=this,c=arguments;return b.map(a[d],function(a){return a.signal("start",c)}).then(function(){return a.weave.apply(a,c)})},"sig/stop":function(){var a=this,c=arguments;return a.unweave.apply(a,c).then(function(){return b.map(a[d],function(a){return a.signal("stop",c)})})},"sig/finalize":function(){var a=arguments;return b.map(this[d],function(b){return b.signal("finalize",a)})}})}),define("troopjs-compose/decorator/after",["../mixin/decorator"],function(a){"use strict";var b,c="value";return function(d){return new a(function(a){var e=a[c];return a[c]=e?function(){var a=this,c=e.apply(a,arguments),f=d.apply(a,arguments);return f!==b?f:c}:d,a})}}),define("troopjs-compose/decorator/before",["../mixin/decorator"],function(a){"use strict";var b,c="value";return function(d){return new a(function(a){var e=a[c];return a[c]=e?function(){var a=this,c=d.apply(a,arguments);return e.apply(a,c!==b?c:arguments)}:d,a})}}),define("troopjs-compose/decorator/extend",["../mixin/decorator","troopjs-util/merge"],function(a,b){"use strict";var c,d="value",e=Array.prototype.concat;return function(f){var g=arguments;return new a(function(a,h,i){var j,k=i[h][d];return"function"==typeof f?j=f(k):k!==c&&(j=b.apply({},e.apply([k],g))),a[d]=j,a})}}),define("troopjs-log/config",["module","troopjs-util/merge"],function(a,b){return b.call({sinks:[]},a.config())}),define("troopjs-log/sink/forward",["./methods","../config","poly/array"],function(a,b){"use strict";var c=Function.apply,d=Array.prototype.slice,e=b.sinks;return function(){var b=this,f=function(a){var f=d.call(arguments,1);e.forEach(function(d){c.call(d[a],b,f)})};return a.forEach(function(a){b[a]=f.bind(b,a)}),b}.call({})}),define("troopjs-log/sink/null",["./methods","poly/array"],function(a){"use strict";return function(){var b=this,c=function(){};return a.forEach(function(a){b[a]=c}),b}.call({})}),define("troopjs-core/component/service",["./gadget"],function(a){"use strict";return a.extend({displayName:"core/component/service"})}),define("troopjs-opt/pubsub/proxy/to1x",["troopjs-core/component/service","when","poly/array","poly/object"],function(a,b){"use strict";var c,d=Array.prototype,e=d.push,f=d.slice,g=Object.keys,h=Object.prototype.toString,i="[object String]",j="publish",k="subscribe",l="hub",m="routes",n="length",o="resolve",p="topic",q="defer",r="memory";return a.extend(function(){var a={};a[m]=f.call(arguments),this.configure(a)},{displayName:"opt/pubsub/proxy/to1x","sig/initialize":function(){var a=this;a.configure()[m].forEach(function(d){if(!(l in d))throw new Error("'"+l+"' is missing from routes");var m=d[j]||{},s=d[k]||{},t=d[l];g(m).forEach(function(d){var g,j,k=m[d];if(h.call(k)===i)g=k,j=!1;else{if(!(p in k))throw new Error("'"+p+"' is missing from target '"+d+"'");g=k[p],j=!!k[q]}var l=m[d]=function(){var a,d,h=[g];return e.apply(h,f.call(arguments)),j&&(a=b.defer(),d=a[o],a[o]=a.resolver[o]=function(){d(f.call(arguments))},e.call(h,a)),t.publish.apply(t,h),a?a.promise:c};l[p]=g,l[q]=j,a.subscribe(d,l)}),g(s).forEach(function(c){var d,g,j=s[c];if(h.call(j)===i)d=j,g=!1;else{if(!(p in j))throw new Error("'"+p+"' is missing from target '"+c+"'");d=j[p],g=!!j[r]}var k=s[c]=function(){var c,g,h=[d];return e.apply(h,f.call(arguments,1)),b.isPromise(h[h[n]-1])&&(c=h.pop()),g=a.publish.apply(a,h),c&&b(g,b.apply(c.resolve),c.reject,c.progress),g};k[p]=d,k[r]=g,t.subscribe(c,a,g,k)})})},"sig/finalize":function(){var a=this;a.configure()[m].forEach(function(b){if(!(l in b))throw new Error("'"+l+"' is missing from routes");var c=b[j]||{},d=b[k]||{},e=b[l];g(c).forEach(function(b){a.unsubscribe(b,c[b])}),g(d).forEach(function(b){e.unsubscribe(b,a,d[b])})})}})}),define("troopjs-opt/pubsub/proxy/to2x",["troopjs-core/component/service","when","poly/array","poly/object"],function(a,b){"use strict";var c=Array.prototype,d=c.push,e=c.slice,f=Object.keys,g=Object.prototype.toString,h="[object String]",i="publish",j="subscribe",k="hub",l="routes",m="topic",n="republish";return a.extend(function(){var a={};a[l]=e.call(arguments),this.configure(a)},{displayName:"opt/pubsub/proxy/to2x","sig/initialize":function(){var a=this;a.configure()[l].forEach(function(b){if(!(k in b))throw new Error("'"+k+"' is missing from routes");var c=b[i]||{},l=b[j]||{},o=b[k];f(c).forEach(function(b){var f,i=c[b];if(g.call(i)===h)f=i;else{if(!(m in i))throw new Error("'"+m+"' is missing from target '"+b+"'");f=i[m]}var j=c[b]=function(){var a=[f];return d.apply(a,e.call(arguments)),o.publish.apply(o,a)};j[m]=f,a.subscribe(b,j)}),f(l).forEach(function(b){var c,f,i=l[b];if(g.call(i)===h)c=i,f=!1;else{if(!(m in i))throw new Error("'"+m+"' is missing from target '"+b+"'");c=i[m],f=!!i[n]}var j=l[b]=function(){var b=[c];return d.apply(b,e.call(arguments)),a.publish.apply(a,b)};j[m]=c,j[n]=f,o.subscribe(b,a,j)})})},"sig/start":function(){var a=this,c=[];return a.configure()[l].forEach(function(b){if(!(k in b))throw new Error("'"+k+"' is missing from routes");var d=b[j]||{},e=b[k];f(d).forEach(function(b){var f=d[b];f[n]===!0&&c.push(e.republish(b,a,f))})}),b.all(c)},"sig/finalize":function(){var a=this;a.configure()[l].forEach(function(b){if(!(k in b))throw new Error("'"+k+"' is missing from routes");var c=b[i]||{},d=b[j]||{},e=b[k];f(c).forEach(function(b){a.unsubscribe(b,c[b])}),f(d).forEach(function(b){e.unsubscribe(b,a,d[b])})})}})}),define("troopjs-opt/route/runner/sequence",["poly/array"],function(){"use strict";var a,b=null,c=Object.prototype.toString,d="context",e="callback",f="data",g="head",h="next",i="type",j="tokens",k=/\(/g,l=/\:(\w+)(\?)?\/?/g,m=/@(\w+)(\?)?\/?/g,n=/\:/g,o="@",p=/\(([^)]+)\)\??\/?/g,q=/^.*$/,r=/([\/.])/g,s=/\/{2,}/,t=/^(?:false|true)$/i,u=/^true$/i,v=/^\d+$/;return function(w,x,y){var z,A,B,C,D=w[i],E=y.shift(),F=[],G=[];if("route/set"===D)z=y.shift()||{},E=E.replace(p,function(a,b){var c=b.replace(l,function(a,b){return b in z?z[b]+"/":a});return c.match(n)?o:c+"/"}).replace(l,function(a,b){return b in z?z[b]+"/":o}).replace(s,"/"),(C=E.indexOf(o))>-1&&(E=E.substring(0,C));else if("route/change"!==D)throw new Error("Unable to run type '"+D+"'");for(B=x[g];B!==a;B=B[h])"/404"===B[f]?G.push(B):F.push(B);var H=F.reduce(function(a,g){var h,i,l;if(a!==!1){switch(c.call(g[f])){case"[object RegExp]":l=g[f],h=g[j];break;case"[object Undefined]":case"[object DOMWindow]":l=q,h=[];break;default:h=g[j]=[],l=g[f]=new RegExp("^"+g[f].replace(n,o).replace(k,"(?:").replace(m,function(a,b,c){return h.push(b),"(?:(\\w+)/)"+(c?"?":"")}).replace(r,"\\$1")+"$","i")}(i=l.exec(E))!==b&&(h.forEach(function(a,b){var c=i[b+1];t.test(c)?c=u.test(c):v.test(c)&&(c=+c),i[b+1]=i[a]=c}),A||(A=1),a=g[e].apply(g[d],[E,i].concat(y)))}return a},a);return A||"route/change"!==D?H:G.reduce(function(a,b){a!==!1?b[e].apply(b[d],[E].concat(y)):a},H)}}),define("troopjs-opt/route/gadget",["troopjs-compose/mixin/config","troopjs-core/component/gadget","./runner/sequence","when"],function(a,b,c,d){"use strict";function e(a){var b=this,d={};return d[j]=h+"/"+a,d[m]=c,arguments[0]=d,b.emit.apply(b,arguments)}var f=Array.prototype,g=f.push,h="route",i="name",j="type",k="value",l="args",m="runner";return a.pragmas.push({pattern:/^route\/(change|set)(\/.*)?$/,replace:h+'/$1("$2")'}),b.extend({displayName:"opt/route/gadget","sig/initialize":function(){var a=this;return d.map(a.constructor.specials[h]||f,function(b){return a.on(b[i],b[k],b[l][0]||void 0)})},"hub:memory/route/change":function(){var a=this,b=["change"];return g.apply(b,arguments),a.task(function(c){c(e.apply(a,b))},h+"/change")},"route/set":function(){var a=this,b=["route/set"];return g.apply(b,arguments),this.publish.apply(a,b)},go:function(){var a=this,b=["set"];return g.apply(b,arguments),a.task(function(c){c(e.apply(a,b))},h+"/set")}})}),define("troopjs-opt/store/component",["troopjs-core/mixin/base","when","poly/array"],function(a,b){"use strict";function c(a){var b=this;return a in b&&b[a].apply(b,m.call(arguments,1))}function d(a,c){for(var d,l=this,m=l[p],n=a?a.split("."):[],o=n.pop();m&&(d=n.shift());)switch(h.call(m)){case i:case j:if(d in m){m=m[d];break}default:m=m[d]={}}return h.call(c)===k&&(c=c.call(l,{get:function(){return e.apply(l,arguments)},has:function(){return f.apply(l,arguments)}},a)),o!==g?b(c,function(a){return m[o]=a,a}):b(c)}function e(a){for(var b,c=this[p],d=a.split(".");c&&(b=d.shift());)switch(h.call(c)){case i:case j:if(b in c){c=c[b];break}default:c=g}return c}function f(a){for(var b,c=this[p],d=a.split("."),e=d.pop();c&&(b=d.shift());)switch(h.call(c)){case i:case j:if(b in c){c=c[b];break}default:c=g}return c!==g&&e in c}var g,h=Object.prototype.toString,i="[object Array]",j="[object Object]",k="[object Function]",l="[object String]",m=Array.prototype.slice,n="length",o="adapters",p="storage",q="beforeGet",r="afterPut",s="clear",t="locks";return a.extend(function(){if(0===arguments[n])throw new Error("No adapter(s) provided");var a=this;a[o]=m.call(arguments),a[p]={},a[t]={}},{displayName:"opt/store/component",lock:function(a,c,d,e){var f,g=this[t];if(h.call(a)!==l)throw new Error("key has to be of type string");return f=g[a]=b(g[a],c,d,e)},get:function(a,d,f,g){var i,j,k=this,p=m.call(arguments);for(i=0,j=p[n];j>i&&h.call(p[i])===l;i++);return d=p[i],f=p[i+1],g=p[i+2],p[n]=i,b.map(p,function(a){return b.map(k[o],function(d){return b(c.call(d,q,k,a))}).then(function(){return e.call(k,a)})}).then(d&&b.apply(d),f,g)},put:function(a,e,f,g,h){var i=this;return b(d.call(i,a,e),function(d){return b.map(i[o],function(e){return b(c.call(e,r,i,a,d))}).yield(d)}).then(f,g,h)},putIfNotHas:function(a,c,d,e,f){var h=this;return h.has(a)?b(g,d,e,f):h.put(a,c,d,e,f)},has:function(a){return f.call(this,a)},clear:function(a,d,e){var f=this;return b.map(f[o],function(a){return b(c.call(a,s,f))}).then(a&&b.apply(a),d,e)}})}),define("troopjs-net/ajax/service",["troopjs-core/component/service","jquery","troopjs-util/merge"],function(a,b,c){"use strict";return a.extend({displayName:"net/ajax/service","hub/ajax":function(a){return b.ajax(c.call({headers:{"x-troopjs-request-id":(new Date).getTime()}},a))}})}),define("troopjs-data/cache/component",["troopjs-core/component/base","poly/object","poly/array"],function(a){"use strict";function b(a,i,u){var v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H[j];if(p in a)if(a[s]=u,w=a[p],w in H){if(v=H[w],a[t]===d)return v}else v=H[w]=a;else v=a;if(i===h)for(x=0,y=a[o];y>x;x++)G=a[x],i=G===f||G===c?c:G[n],v[x]=i===g||i===h&&0!==G[o]?b.call(H,G,i,u):G;else if(i===g){if(a[t]===e)for(F in v)F===p||F===t||F===r||F in a||delete v[F];for(F in a)F===p||F===t&&v[t]===e||(G=a[F],i=G===f||G===c?c:G[n],v[F]=i===g||i===h&&0!==G[o]?b.call(H,G,i,u):G)}a:if(w!==c){if(z=0|u+(v[q]>>>0),r in v){if(A=v[r],A===z)break a;A in I&&delete I[A][w]}if(v[t]!==d)if(v[r]=z,z in I)I[z][w]=v;else if((E=I[z]={})[m]=z,E[w]=v,I[k]!==c){for(C=B=I[k];(D=C[l])!==c&&D[m]<z;C=D);C===B&&C[m]>z?(E[l]=C,I[k]=E):(E[l]=C[l],C[l]=E)
}else I[k]=E}return v}var c,d=!0,e=!1,f=null,g=Object,h=Array,i=1e3,j="generations",k="head",l="next",m="expires",n="constructor",o="length",p="id",q="maxAge",r="expires",s="indexed",t="collapsed";return a.extend(function(){this[j]={}},{displayName:"data/cache/component","sig/finalize":function(){var a=this;Object.keys(a).forEach(function(b){var d;(d=a[b])!==c&&[n]===g&&d.hasOwnProperty(p)&&delete a[b]})},put:function(a){var d=this,e=a===f||a===c?c:a[n];return e===g||e===h&&0!==a[o]?b.call(d,a,e,0|(new Date).getTime()/i):a}})}),define("troopjs-data/cache/service",["troopjs-core/component/service"],function(a){"use strict";function b(a){var b,d,e=this,f=e[h];if(d=f[i],d!==c){do{if(d[k]>a)break;for(b in d)b!==k&&b!==j&&b!==h&&delete e[b];delete f[d[k]]}while(d=d[j]);f[i]=d}}var c,d=Array.prototype.slice,e="_caches",f="_timeout",g=1e3,h="generations",i="head",j="next",k="expires",l="length";return a.extend(function(){this[e]=d.call(arguments)},{"sig/start":function(a){function d(){var c,e,j=0|(new Date).getTime()/g;for(c=0,e=i[l];e>c;c++)b.call(i[c],j),h[f]=setTimeout(d,a)}var h=this,i=h[e];a===c&&(a=60*g),d()},"sig/stop":function(){var a=this;clearTimeout(a[f])}})}),define("troopjs-data/query/component",["troopjs-core/mixin/base"],function(a){"use strict";var b,c=!0,d=!1,e=Object,f=Array,g="constructor",h="length",i="op",j="!",k=".",l=",",m="|",n="text",o="raw",p="resolved",q="id",r="expires",s="collapsed",t="_ast",u="_query",v=/("|')(.*?)\1/,w="$2",x=/!(.*[!,|.\s]+.*)/,y="!'$1'";return a.extend(function(a){var c=this;a!==b&&(c[u]=a)},{displayName:"data/query/component",parse:function(a){var c=this;delete c[t],a=c[u]=a||c[u]||"";var d,e,f,g,p,q,r=[];for(d=g=0,e=a[h];e>d;d++)switch(f=a.charAt(d)){case'"':case"'":p=p===f?b:f;break;case j:if(p!==b)break;q={},q[i]=f;break;case k:case l:if(p!==b)break;q!==b&&(q[o]=(q[n]=a.substring(g,d)).replace(v,w),r.push(q)),q={},q[i]=f,g=d+1;break;case m:case" ":case"	":case"\r":case"\n":if(p!==b)break;q!==b&&(q[o]=(q[n]=a.substring(g,d)).replace(v,w),r.push(q)),q=b,g=d+1}return q!==b&&(q[o]=(q[n]=a.substring(g,e)).replace(v,w),r.push(q)),c[t]=r,c},reduce:function(a){var m=this,u=0|(new Date).getTime()/1e3;t in m||m.parse();var v,w,z,A,B,C,D,E,F=m[t],G=[],H=d,I=d;for(v=0,A=F[h];A>v;v++)switch(B=F[v],B[i]){case j:D=B,C=B[o],C in a?(E=a[C],H=B[p]=E[s]!==c&&!(r in E&&E[r]<u)):(E=b,H=B[p]=d);break;case k:if(C=B[o],H)if(E&&C in E)if(E=E[C],z=E[g],z===f){for(B[p]=c,w=E[h];w-->0;)if(z=E[w],z[g]===e&&q in z&&(z[s]===c||r in z&&z[r]<u)){B[p]=d;break}}else z===e&&q in E?(B[i]=j,B[n]=(B[o]=E[q]).replace(x,y),B[p]=E[s]!==c&&!(r in E&&E[r]<u)):B[p]=c;else E=b,B[p]=d;else B[p]=d;break;case l:C=D[o],E=a[C],B[i]=j,B[n]=D[n],B[o]=C,B[p]=D[p]}for(;A-->0;)switch(B=F[A],B[i]){case j:(I||B[p]!==c)&&G.unshift(B),I=d;break;case k:G.unshift(B),I=c}return m[t]=G,m},ast:function(){var a=this;return t in a||a.parse(),a[t]},rewrite:function(){var a=this;t in a||a.parse();var b,c,d,e=a[t],f="";for(c=0,b=e[h];b>c;c++)switch(d=e[c],d[i]){case j:f+=0===c?d[n]:m+d[n];break;case k:f+=k+d[n]}return f}})}),define("troopjs-data/query/service",["module","troopjs-core/component/service","./component","troopjs-util/merge","when"],function(a,b,c,d,e){"use strict";var f,g=Array.prototype,h=g.slice,i=g.concat,j=g.push,k="length",l="batches",m="interval",n="cache",o="queries",p="resolved",q="configuration",r="raw",s="id",t="q",u=a.config();return b.extend(function(a){var b=this;if(a===f)throw new Error("No cache provided");b[l]=[],b[n]=a,b.configure(u)},{displayName:"data/query/service","sig/start":function(){var a=this,b=a[n];a[m]=m in a?a[m]:setInterval(function(){function c(){var b,c=[];for(b=g[k];b--;)j.apply(c,g[b][t]);return a.publish("ajax",d.call({data:{q:c.join("|")}},a[q]))}function e(a){var c,d,e,f,h;for(b.put(a),f=g[k];f--;){for(c=g[f],d=c[o],e=c[s],h=d[k];h--;)h in e&&(d[h]=b[e[h]]);c.resolve(d)}}function f(){var a,b;for(b=g[k];b--;)a=g[b],a.reject(a[o])}var g=a[l];0!==g[k]&&(a[l]=[],c().then(e,f))},200)},"sig/stop":function(){var a=this;m in a&&(clearInterval(a[m]),delete a[m])},"hub/query":function(a){var b,d,f,m,q,u=this,v=u[l],w=u[n],x=[],y=[],z=e.defer(),A=z.resolver;try{for(q=i.apply(g,h.call(arguments)),d=0,m=q[k];m>d;d++)for(a=c(q[d]),b=a.ast(),b[k]>0&&(y[d]=b[0][r]),b=a.reduce(w).ast(),f=b[k];f-->0;)if(!b[f][p]){j.call(x,a.rewrite());break}if(0===x[k]){for(d=0;m>d;d++)d in y&&(q[d]=w[y[d]]);A.resolve(q)}else A[o]=q,A[s]=y,A[t]=x,v.push(A)}catch(B){A.reject(B)}return z.promise}})}),define("troopjs-jquery/hashchange",["jquery"],function(a){"use strict";function b(a){var b=g.exec(a.location.href);return b&&b[1]?decodeURIComponent(b[1]):""}function c(a){var b,c=this;c.element=b=a.createElement("iframe"),b.src="about:blank",b.style.display="none"}var d="interval",e="hashchange",f="on"+e,g=/#(.*)$/,h=/\?/,i=!1;c.prototype={getElement:function(){return this.element},getHash:function(){return this.element.contentWindow.frameHash},update:function(a){var b=this,c=b.element.contentWindow.document;b.getHash()!==a&&(c.open(),c.write("<html><head><title>' + document.title + '</title><script type='text/javascript'>var frameHash='"+a+"';</script></head><body>&nbsp;</body></html>"),c.close())}},a.event.special[e]={setup:function(){var g=this;if(f in g)return!1;if(!a.isWindow(g))throw new Error("Unable to bind 'hashchange' to a non-window object");var j=a(g),k=b(g),l=g.location;j.data(d,g.setInterval(i?function(){var a=g.document,d="file:"===l.protocol,f=new c(a);return a.body.appendChild(f.getElement()),f.update(k),function(){var a,c=k,i=b(g),m=f.getHash();m!==k&&m!==i?(a=decodeURIComponent(m),k!==a&&(k=a,f.update(k),j.trigger(e,[a,c])),l.hash="#"+encodeURI(d?m.replace(h,"%3F"):m)):i!==k&&(a=decodeURIComponent(i),k!==a&&(k=a,j.trigger(e,[a,c])))}}():function(){var a,c=k,d=b(g);d!==k&&(a=decodeURIComponent(d),k!==a&&(k=a,j.trigger(e,[a,c])))},25))},teardown:function(){var b=this;return f in b?!1:void b.clearInterval(a.data(b,d))}}}),define("troopjs-dom/hash/widget",["../component/widget","troopjs-jquery/hashchange"],function(a){"use strict";var b="$element",c="_hash",d=/^#/;return a.extend({displayName:"dom/hash/widget","sig/start":function(){this[b].trigger("hashchange")},"dom/hashchange":function(a){var e=this,f=e[b].get(0).location.hash.replace(d,"");f!==e[c]?e.publish("route/change",e[c]=f):a.stopImmediatePropagation()},"dom/hashset":function(a,b,c){this.publish("route/set",b,null,c)},"hub/route/set":function(a,d,e){var f=this;e===!0&&(f[c]=a),f[b].get(0).location.hash=a}})}),define("troopjs-dom/loom/woven",["./config","when","jquery","poly/array"],function(a,b,c){"use strict";var d=Array.prototype.map,e="length",f="woven",g=a.$warp;return function(){var a,h=[],i=0;return arguments[e]>0?(a=new RegExp(d.call(arguments,function(a){return"^"+a}).join("|"),"m"),c(this).each(function(d,e){var j=(c.data(e,g)||[]).filter(function(b){return a.test(b[f])});h[i++]=b.all(j)})):c(this).each(function(a,d){h[i++]=b.all(c.data(d,g))}),b.all(h)}}),define("troopjs-dom/loom/plugin",["jquery","when","./config","./weave","./unweave","./woven","troopjs-util/getargs","poly/array"],function(a,b,c,d,e,f,g){"use strict";function h(b){return a(b).attr(q)!==j}function i(b){return a(b).attr(r)!==j}var j,k=a.fn,l=a.expr,m=l.createPseudo,n="weave",o="unweave",p="woven",q=c[n],r=c[p],s=/[\s,]+/;l[":"][n]=m?m(function(b){return b===j?h:(b=new RegExp(g.call(b).map(function(a){return"^"+a}).join("|"),"m"),function(c){var d=a(c).attr(q);return d!==j&&b.test(d.replace(s,"\n"))})}):function(b,c,d){var e=a(b).attr(q);return e===j?!1:d===j?!0:new RegExp(g.call(d[3]).map(function(a){return"^"+a}).join("|"),"m").test(e.replace(s,"\n"))},l[":"][p]=m?m(function(b){return b===j?i:(b=new RegExp(g.call(b).map(function(a){return"^"+a}).join("|"),"m"),function(c){var d=a(c).attr(r);return d!==j&&b.test(d.replace(s,"\n"))})}):function(b,c,d){var e=a(b).attr(r);return e===j?!1:d===j?!0:new RegExp(g.call(d[3]).map(function(a){return"^"+a}).join("|"),"m").test(e.replace(s,"\n"))},k[n]=d,k[o]=e,k[p]=f}),define("troopjs-requirejs/multiversion",[],function(){"use strict";var a,b=/(.+?)#(.+)$/,c=/^empty:/,d=require.s.contexts;return{load:function(e,f,g){var h,i;null!==(i=b.exec(e))&&(e=i[1],h=i[2],h in d&&(f=d[h].require)),c.test(f.toUrl(e+".js"))?g(a):f([e],function(a){g(a)},g.error)}}}),define("troopjs-requirejs/shadow",["text"],function(a){"use strict";function b(a,b){for(var c,d=/([^=&]+)=([^&]+)/g,f=[],g=[];b&&(c=d.exec(b));)c[1]===e?a+=";\nreturn "+c[2]+";\n":(f.push("'"+c[2]+"'"),g.push(c[1]));return"define(["+f.join(", ")+"], function ("+g.join(", ")+") {\n"+a+"});"}function c(a,b){var c,d,e;for(a=a.split("."),b=b.split("."),d=Math.min(a.length,b.length),e=0;d>e;e++)if(c=parseInt(a[e],null)-parseInt(b[e],null),0!==c)return c;return a.length-b.length}var d,e="exports",f=".js",g=/(.+?)#(.+)$/,h=/^empty:/,i=require.version,j={};return{load:function(e,k,l,m){var n,o,p,q,r=e;(n=g.exec(e))&&(r=n[1],o=n[2]),q=k.toUrl(r+f),h.test(q)?l(d):a.get(q,function(a){p=b(a,o),m.isBuild&&(j[e]=p),l.fromText(e,p),c(i,"2.1.0")<0&&k([e],l)})},write:function(a,b,c){var d;b in j&&(d=j[b],d=d.replace(/define\(/,function(c){return c+'"'+[a,b].join("!")+'",'}),c(d))}}}),define("troopjs-util/select",[],function(){"use strict";var a,b=!1,c=".",d="[",e="]",f="'",g='"';return function(h){var i,j,k,l,m=this,n=b;for(k=j=0,l=h.length;l>k&&m!==a;k++)switch(i=h.charAt(k)){case c:n===b&&k>j&&(m=m[h.substring(j,k)],j=k+1);break;case d:n===b&&(n=d,j=k+1);break;case e:n===d&&k>j&&(m=m[h.substring(j,k)],n=b,j=k+2);break;case g:case f:n===i&&k>j?(m=m[h.substring(j,k)],n=b,j=k+2):(n=i,j=k+1)}return k>j&&(m=m[h.substring(j,k)]),m}}),define("troopjs-requirejs/json",["text","troopjs-util/select","poly/json"],function(a,b){"use strict";var c=null,d=/(.+?)#(.+)$/,e={};return{load:function(f,g,h,i){var j,k=f,l="";(j=d.exec(f))!==c&&(f=j[1],l=j[2]),a.get(g.toUrl(f),function(a){var c=b.call(JSON.parse(a),l);i.isBuild&&(e[k]=c),h(c)},h.error)},write:function(a,b,c){b in e&&c("define('"+a+"!"+b+"', function(){ return "+JSON.stringify(e[b])+"});")}}});