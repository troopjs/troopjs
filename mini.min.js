/**
 * troopjs - 2.0.2-8+e051bdc © Mikael Karon mailto:mikael@karon.se
 * @license MIT http://troopjs.mit-license.org/
 */
define("troopjs-utils/unique",[],function(){"use strict";var a="length";return function(b){var c,d,e,f,g=this,h=g[a];if(b)a:for(d=f=0;h>d;d++){for(c=g[d],e=0;d>e;e++)if(b.call(g,c,[e])===!0)continue a;g[f++]=c}else a:for(d=f=0;h>d;d++){for(c=g[d],e=0;d>e;e++)if(c===g[e])continue a;g[f++]=c}return g[a]=f,f}}),define("troopjs-core/component/factory",["troopjs-utils/unique","poly/object"],function(a){"use strict";function b(){return c.apply(this,arguments)()}function c(){var a=[this];return m.apply(a,arguments),i.apply(null,a)}function d(a,b){var c={};c[v]={value:a},c[u]={value:b},Object.defineProperties(this,c)}function e(a){return new d(a,e[u])}function f(a){return new d(a,f[u])}function g(a){return new d(a,g[u])}function h(){var a=this,b=a[j];return q in b?b[q]:o.call(a)}function i(){function e(){var a,b=this instanceof e?this:Object.create(Q),c=arguments;for(Object.defineProperty(b,z,{value:e}),a=0;l>a;a++)c=P[a].apply(b,c)||c;return b}var f,g,i,l,o,q,v,w,x,y,I,J,K,L,M=[],N=arguments,O=N[r],P=[],Q={},R={},S={};for(w=0;O>w;w++){if(i=N[w],typeof i===p){if(A in i?m.apply(P,i[A]):m.call(P,i),B in i&&n.apply(M,i[B]),i===i[j][z])continue;i=i[j]}for(q=Object.getOwnPropertyNames(i),x=0,v=q[r];v>x;x++)o=q[x],(J=H.exec(o))?(f={},f[C]=y=J[1],f[E]=J[2],f[F]=I=J[3],f[G]=y+"/"+I,f[D]=i[o],n.call(M,f)):(L=Object.getOwnPropertyDescriptor(i,o),K=L[D],R[o]=K instanceof d?K[u](R[o]||{enumerable:!0,configurable:!0,writable:!0}):L)}for(Object.defineProperties(Q,R),l=a.call(P),g=a.call(M),w=0;g>w;w++)f=M[w],y=f[C],I=f[F],o=f[G],y=y in M?M[y]:M[y]=[],I=I in y?y[I]:y[I]=M[o]=[],y[y[r]]=I[I[r]]=f;return S[j]={value:Q},S[A]={value:P},S[B]={value:M},S[k]={value:h},S[s]={value:c},S[t]={value:b},Object.defineProperties(e,S),e}var j="prototype",k="toString",l=Array[j],m=l.push,n=l.unshift,o=Object[j][k],p="function",q="displayName",r="length",s="extend",t="create",u="decorate",v="decorated",w="before",x="after",y="around",z="constructor",A="constructors",B="specials",C="group",D="value",E="features",F="type",G="name",H=/^(\w+)(?::(.+?))?\/([-_./\d\w\s]+)$/,I=function(){},J={};return e[u]=function(a){var b=this[v],c=a[D];return a[D]=c?function(){var a=this,d=arguments;return c.apply(a,d=b.apply(a,d)||d)}:b,a},f[u]=function(a){var b=a[D],c=this[v];return a[D]=b?function(){var a=this,d=arguments;return c.apply(a,d=b.apply(a,d)||d)}:c,a},g[u]=function(a){return a[D]=this[v](a[D]||I),a},J[t]={value:function(){return i.apply(null,arguments)()}},J[w]={value:e},J[x]={value:f},J[y]={value:g},Object.defineProperties(i,J),i}),define("troopjs-utils/merge",["poly/object"],function(){"use strict";var a="length",b=Array.prototype,c=b.concat,d=Object.prototype,e=d.toString,f=e.call(d),g=e.call(b);return function h(b){var d,i,j,k,l,m,n,o,p,q,r=this;for(j=0,l=arguments[a];l>j;j++)for(b=arguments[j],i=Object.keys(b),k=0,m=i[a];m>k;k++)d=i[k],n=b[d],o=r[d],d in r?(p=e.call(n),q=e.call(o),q===f&&p===f?h.call(o,n):r[d]=q===g&&p===g?c.call(o,n):n):r[d]=n;return r}}),define("troopjs-core/component/base",["./factory","when","troopjs-utils/merge"],function(a,b,c){"use strict";var d=Array.prototype,e=d.push,f=d.slice,g="instanceCount",h="configuration",i="context",j="name",k="value",l="phase",m="started",n="finished",o="initialize",p="stop",q="sig",r=0;return a(function(){var a=this;a[g]=++r,a[h]={}},{instanceCount:r,displayName:"core/component/base",configure:function(){return c.apply(this[h],arguments)},signal:function(a){function c(a){return++m>-1&&(l[m]=a),(d=i[j++])?b(d[k].apply(e,g),c):b.resolve(l)}var d,e=this,g=f.call(arguments,1),h=e.constructor.specials,i=q in h&&h[q][a]||[],j=0,l=[],m=-2;return c(g)},start:function(){var a=this,b=a.signal,c=[o];return a[l]=o,e.apply(c,arguments),b.apply(a,c).then(function(e){return c[0]=a[l]="start",b.apply(a,c).then(function(b){return a[l]="started",d.concat(e,b)})})},stop:function(){var a=this,b=a.signal,c=[p];return a[l]=p,e.apply(c,arguments),b.apply(a,c).then(function(e){return c[0]=a[l]="finalize",b.apply(a,c).then(function(b){return a[l]="finalized",d.concat(e,b)})})},task:function(a,c){var d=this,e=b.promise(a).ensure(function(){e[n]=new Date});return e[i]=d,e[m]=new Date,e[j]=c,d.signal("task",e).yield(e)},toString:function(){var a=this;return a.displayName+"@"+a[g]}})}),define("troopjs-core/logger/console",["../component/base","poly/function"],function(a){"use strict";function b(){}var c=console,d={};return["info","log","debug","warn","error"].reduce(function(a,d){return a[d]="undefined"!=typeof c&&c[d]?c[d]:b,a},d),a.create({displayName:"core/logger/console"},d)}),define("troopjs-core/event/emitter",["../component/base","when","poly/array"],function(a,b){"use strict";function c(a,c,d){d=d||[];var e=0,f=d[j],g=f-1,k=function(j){var l,m;for(g++>=f&&(d[g]=j);(m=a[e++])&&(l=m[h])&&r.test(l[p]););return m?(m[n]=c)===c&&b(m[i].apply(l,j),k):b.resolve(d)};return k}function d(a,c,d){d=d||{};var f,j=0,k=function(l){var m,o;for(l!==e&&(d[g]=f=l);(o=a[j++])&&(m=o[h])&&r.test(m[p]););return o?(o[n]=c)===c&&b(o[i].apply(m,f),k):b.resolve(f)};return k}var e,f=null,g="memory",h="context",i="callback",j="length",k="head",l="tail",m="next",n="handled",o="handlers",p="phase",q=/^(\w+)(?::(pipeline|sequence))/,r=/^(?:initi|fin)alized?$/,s=Array.prototype.slice;return a.extend(function(){this[o]={}},{displayName:"core/event/emitter",on:function(a,b,c){var d,f,g,j=this,p=arguments,q=j[o],r=2;if((c=p[r++])===e)throw new Error("no callback provided");if(a in q){q=q[a],d={},d[i]=c,d[h]=b,g=l in q?q[l][m]=d:q[k]=d;for(;(c=p[r++])!==e;)g=g[m]=d={},d[i]=c,d[h]=b;q[l]=g}else{for(f=g=d={},d[i]=c,d[h]=b;(c=p[r++])!==e;)g=g[m]=d={},d[i]=c,d[h]=b;q=q[a]={},q[k]=f,q[l]=g,q[n]=0}return j},off:function(a,b){var c,d,e,f,g,n=this,p=arguments,q=p[j],r=n[o];if(!(a in r))return n;if(r=r[a],!(k in r))return n;c=r[k];do{if(!b||!c[h]||c[h]===b){for(g=!1,f=2;q>f;f++)if(c[i]===p[f]){g=!0;break}if(g)continue}d?e=e[m]=c:d=e=c}while(c=c[m]);return d&&e?(r[k]=d,r[l]=e,delete e[m]):(delete r[k],delete r[l]),n},emit:function(a){var e,h,i,j,l,p=this,r=s.call(arguments,1),t=p[o];if((j=q.exec(a))!==f&&(a=j[1],l=j[2]),a in t){if(t=t[a],k in t){h=[],i=0,e=t[k];do h[i++]=e;while(e=e[m]);return"sequence"===l?c(h,++t[n])(r):d(h,++t[n],t)(r)}}else t[a]=t={},t[n]=0;return t[g]=r,b.resolve(r)},reemit:function(a,e,l){var p,r,s,t,u,v,w,x,y=this,z=arguments,A=z[j],B=y[o];if((u=q.exec(a))!==f&&(a=u[1],v=u[2]),a in B&&(B=B[a],g in B)){if(!(k in B))return b.resolve(B[g]);s=[],t=0,p=B[k],r=B[n];do if(!l||!p[h]||p[h]===l){for(x=!1,w=3;A>w;w++)if(p[i]===z[w]){x=!0;break}(!x||p[n]!==r||e)&&(s[t++]=p)}while(p=p[m]);return"sequence"===v?c(s,r)(B[g]):d(s,r)(B[g])}return b.resolve()}})}),define("troopjs-core/pubsub/hub",["../event/emitter"],function(a){"use strict";var b=a.prototype;return a.create({displayName:"core/pubsub/hub",subscribe:b.on,unsubscribe:b.off,publish:b.emit,republish:b.reemit})}),define("troopjs-core/logger/pubsub",["../component/base","../pubsub/hub"],function(a,b){"use strict";var c=Array.prototype.push,d=b.publish;return a.create({displayName:"core/logger/pubsub",log:function(){var a=["logger/log"];c.apply(a,arguments),d.apply(b,a)},warn:function(){var a=["logger/warn"];c.apply(a,arguments),d.apply(b,a)},debug:function(){var a=["logger/debug"];c.apply(a,arguments),d.apply(b,a)},info:function(){var a=["logger/info"];c.apply(a,arguments),d.apply(b,a)},error:function(){var a=["logger/error"];c.apply(a,arguments),d.apply(b,a)}})}),define("troopjs-core/component/gadget",["../event/emitter","when","../pubsub/hub"],function(a,b,c){"use strict";var d=Array.prototype,e=d.slice,f=d.push,g=c.publish,h=c.republish,i=c.subscribe,j=c.unsubscribe,k="length",l="features",m="type",n="value",o="subscriptions",p=a.prototype,q=p.on,r=p.off,s=p.reemit;return a.extend(function(){this[o]=[]},{displayName:"core/component/gadget","sig/initialize":function(){var a,b,d,e,f,g,h=this,j=h[o],p=h.constructor.specials.hub;for(d=0,e=p?p[k]:0;e>d;d++)b=p[d],a=j[d]={},a[m]=f=b[m],a[l]=b[l],a[n]=g=b[n],i.call(c,f,h,g)},"sig/start":function(){var a,d,e,f=this,g=arguments,i=f[o],j=[],p=0;for(d=0,e=i[k];e>d;d++)a=i[d],"memory"===a[l]&&(j[p++]=h.call(c,a[m],!1,f,a[n]));return b.all(j).yield(g)},"sig/finalize":function(){var a,b,d,e=this,f=e[o];for(b=0,d=f[k];d>b;b++)a=f[b],j.call(c,a[m],e,a[n])},"sig/task":function(a){return this.publish("task",a)},reemit:function(a,b){var c=this,d=[a,b,c];return f.apply(d,e.call(arguments,2)),s.apply(c,d)},on:function(a){var b=this,c=[a,b];return f.apply(c,e.call(arguments,1)),q.apply(b,c)},off:function(a){var b=this,c=[a,b];return f.apply(c,e.call(arguments,1)),r.apply(b,c)},publish:function(){return g.apply(c,arguments)},republish:function(a,b){var d=this,g=[a,b,d];return f.apply(g,e.call(arguments,2)),h.apply(c,g)},subscribe:function(a){var b=this,d=[a,b];return f.apply(d,e.call(arguments,1)),i.apply(c,d),b},unsubscribe:function(a){var b=this,d=[a,b];return f.apply(d,e.call(arguments,1)),j.apply(c,d),b}})}),define("troopjs-core/component/service",["./gadget"],function(a){"use strict";return a.extend({displayName:"core/component/service","sig/initialize":function(){var a=this;return a.publish("registry/add",a)},"sig/finalize":function(){var a=this;return a.publish("registry/remove",a)}})}),define("troopjs-core/logger/service",["../component/service","troopjs-utils/merge","when"],function(a,b,c){"use strict";function d(a,b){var d=this,e=d.signal,f=[a],g=d[m],h=0;i.apply(f,b);var j=function(){var a;return(a=g[h++])?c(e.apply(a,f),j):c.resolve(b)};return j()}function e(a,c){var d={cat:a,time:(new Date).getTime()};return j.call(c)===k?b.call(d,c):d.msg=c,d}function f(a){var b,c,d=this,e=d[m];for(b=0,c=e[l];c>b;b++)e[b].append(a)}var g=Array.prototype,h=g.slice,i=g.push,j=Object.prototype.toString,k="[object Object]",l="length",m="appenders";return a.extend(function(){this[m]=h.call(arguments)},{displayName:"core/logger/service","sig/initialize":function(){return d.call(this,"initialize",arguments)},"sig/start":function(){return d.call(this,"start",arguments)},"sig/stop":function(){return d.call(this,"stop",arguments)},"sig/finalize":function(){return d.call(this,"finalize",arguments)},"hub/logger/log":function(a){f.call(this,e("log",a))},"hub/logger/warn":function(a){f.call(this,e("warn",a))},"hub/logger/debug":function(a){f.call(this,e("debug",a))},"hub/logger/info":function(a){f.call(this,e("info",a))},"hub/logger/error":function(a){f.call(this,e("error",a))}})}),define("troopjs-net/ajax/service",["troopjs-core/component/service","jquery","troopjs-utils/merge"],function(a,b,c){"use strict";return a.extend({displayName:"net/ajax/service","hub/ajax":function(a){return b.ajax(c.call({headers:{"x-troopjs-request-id":(new Date).getTime()}},a))}})}),define("troopjs-browser/loom/config",["module","troopjs-utils/merge"],function(a,b){"use strict";return b.call({$warp:"$warp",$weft:"$weft",weave:"data-weave",unweave:"data-unweave",woven:"data-woven"},a.config())}),define("troopjs-utils/getargs",[],function(){"use strict";var a=Array.prototype.push,b=String.prototype.substring,c=/^(?:false|true)$/i,d=/^true$/i,e=/^\d+$/;return function(){var f,g,h,i,j,k,l=this,m=[],n=!1;for(g=h=i=0,f=l.length;f>i;i++)switch(j=l.charAt(i)){case'"':case"'":n===j?(n=!1,a.call(m,b.call(l,g,h))):n=j,g=h=i+1;break;case",":if(n){h=i+1;break}g!==h&&(k=b.call(l,g,h),c.test(k)?k=d.test(k):e.test(k)&&(k=+k),a.call(m,k)),g=h=i+1;break;case" ":case"	":if(n){h=i+1;break}g===h&&(g=h=i+1);break;default:h=i+1}return g!==h&&(k=b.call(l,g,h),c.test(k)?k=d.test(k):e.test(k)&&(k=+k),a.call(m,k)),m}}),define("troopjs-browser/loom/weave",["./config","require","when","jquery","troopjs-utils/getargs","poly/array"],function(a,b,c,d,e){"use strict";var f,g=null,h=Array.prototype,i=h.map,j=h.push,k="weave",l="woven",m=a.$warp,n=a.$weft,o=a[k],p=a[l],q=/[\s,]+/;return function(){var a=arguments;return c.all(i.call(this,function(h){var i,r,s=d(h),t=s.data(),u=t[m]||(t[m]=[]),v=[],w=s.attr(o)||"",x=/[\s,]*(([\w_\-\/\.]+)(?:\(([^\)]+)\))?)/g,y=function(a){var b=a[n][l];s.attr(p,function(a,c){var d=[b];return c!==f&&j.apply(d,c.split(q)),d.join(" ")})};for(s.removeAttr(o);(r=x.exec(w))!==g;)i=[s,r[2]],i[k]=r[1],r[3]!==f&&j.apply(i,e.call(r[3]).map(function(a){return a in t?t[a]:a})),j.call(v,i);return c.all(v.map(function(d){var e=c.defer(),f=e.resolver,g=e.promise;return g[k]=d[k],j.call(u,g),c(g,y),b([d[1]],function(b){var c;try{c=b.apply(b,d),c[n]=g,g[l]=c.toString(),f.resolve(c.start.apply(c,a).yield(c))}catch(e){f.reject(e)}},f.reject),g}))}))}}),define("troopjs-browser/loom/unweave",["./config","when","jquery","poly/array"],function(a,b,c){"use strict";var d,e=null,f=Array.prototype,g=f.map,h=f.push,i="weave",j="unweave",k="woven",l="length",m=a.$warp,n=a.$weft,o=a[i],p=a[k],q=a[j],r=/[\s,]+/;return function(){var a=arguments;return b.all(g.call(this,function(f){var g,j,s,t,u,v=c(f),w=v.data(),x=w[m]||(w[m]=[]),y=[],z=v.attr(q),A=[],B=/[\s,]*([\w_\-\/\.]+)(?:@(\d+))?/g,C=function(a){var b=a[n],c=b[k],e=b[i];v.attr(p,function(a,b){var e=[];return b!==d&&h.apply(e,b.split(r).filter(function(a){return a!==c})),0===e[l]?null:e.join(" ")}).attr(o,function(a,b){var c=[e];return b!==d&&h.apply(c,b.split(r)),c.join(" ")})};if(v.removeAttr(q),z===d)h.apply(y,x),x[l]=0;else{for(;(g=B.exec(z))!==e;)h.call(A,"^"+g[1]+"@"+(g[2]||"\\d+")+"$");for(A=new RegExp(A.join("|")),t=u=0,s=x[l];s>t;t++)j=x[t],A.test(j[k])?h.call(y,j):x[u++]=j;x[l]=u}return b.map(y,function(c){var d=c.stop.apply(c,a).yield(c);return b(d,C),d})}))}}),define("troopjs-browser/loom/woven",["./config","when","jquery","poly/array"],function(a,b,c){"use strict";var d=Array.prototype.map,e="length",f="woven",g=a.$warp;return function(){var a,h=[],i=0;return arguments[e]>0?(a=RegExp(d.call(arguments,function(a){return"^"+a}).join("|"),"m"),c(this).each(function(d,e){var j=(c.data(e,g)||[]).filter(function(b){return a.test(b[f])});h[i++]=b.all(j)})):c(this).each(function(a,d){h[i++]=b.all(c.data(d,g))}),b.all(h)}}),define("troopjs-browser/loom/plugin",["jquery","when","./config","./weave","./unweave","./woven","troopjs-utils/getargs","poly/array"],function(a,b,c,d,e,f,g){"use strict";function h(b){return a(b).attr(q)!==j}function i(b){return a(b).attr(r)!==j}var j,k=a.fn,l=a.expr,m=l.createPseudo,n="weave",o="unweave",p="woven",q=c[n],r=c[p],s=/[\s,]+/;l[":"][n]=m?m(function(b){return b===j?h:(b=new RegExp(g.call(b).map(function(a){return"^"+a}).join("|"),"m"),function(c){var d=a(c).attr(q);return d!==j&&b.test(d.replace(s,"\n"))})}):function(b,c,d){var e=a(b).attr(q);return e===j?!1:d===j?!0:new RegExp(g.call(d[3]).map(function(a){return"^"+a}).join("|"),"m").test(e.replace(s,"\n"))},l[":"][p]=m?m(function(b){return b===j?i:(b=new RegExp(g.call(b).map(function(a){return"^"+a}).join("|"),"m"),function(c){var d=a(c).attr(r);return d!==j&&b.test(d.replace(s,"\n"))})}):function(b,c,d){var e=a(b).attr(r);return e===j?!1:d===j?!0:new RegExp(g.call(d[3]).map(function(a){return"^"+a}).join("|"),"m").test(e.replace(s,"\n"))},k[n]=d,k[o]=e,k[p]=f}),define("troopjs-jquery/destroy",["jquery"],function(a){"use strict";var b="destroy";a.event.special[b]={noBubble:!0,trigger:function(){return!1},remove:function(b){var c=this;b&&b.handler.call(c,a.Event({type:b.type,data:b.data,namespace:b.namespace,target:c}))}}}),define("troopjs-browser/component/widget",["troopjs-core/component/gadget","jquery","../loom/config","../loom/weave","../loom/unweave","../loom/plugin","troopjs-jquery/destroy"],function(a,b,c,d,e){"use strict";function f(a,b){return function(){return b.apply(a,arguments)}}function g(a){function b(b){var c=this,e=i.call(arguments,1);return d.call(a.call(c[k],typeof b===j?b.apply(c,e):b).find(s))}return b}var h,i=Array.prototype.slice,j="function",k="$element",l="$handlers",m="features",n="type",o="value",p="proxy",q="guid",r="length",s="["+c.weave+"]",t="["+c.unweave+"]";return a.extend(function(a,b){var c=this;if(a===h)throw new Error("No $element provided");c[k]=a,c[l]=[],b!==h&&(c.displayName=b)},{displayName:"browser/component/widget","sig/initialize":function(){var a,b,c,d,e,g,h,i,j=this,s=j[k],t=j[l],u=j.constructor.specials.dom;for(h=0,i=u?u[r]:0;i>h;h++)b=u[h],a=t[h]={},a[n]=c=b[n],a[m]=d=b[m],a[o]=e=b[o],a[p]=g=f(j,e),s.on(c,d,j,g),e[q]=g[q]},"sig/finalize":function(){var a,b,c,d=this,e=d[k],f=d[l];for(b=0,c=f[r];c>b;b++)a=f[b],e.off(a[n],a[m],a[p])},"sig/task":function(a){this[k].trigger("task",[a])},weave:function(){return d.apply(this[k].find(s),arguments)},unweave:function(){return e.apply(this[k].find(t).addBack(),arguments)},"dom/destroy":function(){this.unweave()},before:g(b.fn.before),after:g(b.fn.after),html:g(b.fn.html),text:g(b.fn.text),append:g(b.fn.append),prepend:g(b.fn.prepend)})}),define("troopjs-core/registry/service",["../component/service","poly/object","poly/array"],function(a){"use strict";var b="services";return a.extend(function(){var a=this;a[b]={},a.add(a)},{displayName:"core/registry/service",add:function(a){this[b][a.toString()]=a},remove:function(a){delete this[b][a.toString()]},get:function(a){var c=new RegExp(a),d=this[b];return Object.keys(d).filter(function(a){return c.test(a)}).map(function(a){return d[a]})},"hub/registry/add":function(a){return this.add(a)},"hub/registry/remove":function(a){return this.remove(a)},"hub/registry/get":function(a){return this.get(a)}})}),define("troopjs-browser/application/widget",["module","../component/widget","when","troopjs-core/registry/service","poly/array"],function(a,b,c,d){"use strict";function e(a,b){var d=this,e=d.signal,f=[a],g=d[i].get(),j=0;h.apply(f,b);var k=function(){var a;return(a=g[j++])?c(e.apply(a,f),k):c.resolve(b)};return k()}var f=Array.prototype,g=f.slice,h=f.push,i="registry";return b.extend(function(){var a=this[i]=d();g.call(arguments,2).forEach(function(b){a.add(b)})},{displayName:"browser/application/widget","sig/initialize":function(){return e.call(this,"initialize",arguments)},"sig/start":function(){var a=this,b=a.weave,c=arguments;return e.call(a,"start",c).then(function(){return b.apply(a,c)})},"sig/stop":function(){var a=this,b=a.unweave,c=arguments;return b.apply(a,c).then(function(){return e.call(a,"stop",c)})},"sig/finalize":function(){return e.call(this,"finalize",arguments)}})}),define("troopjs-data/store/component",["troopjs-core/component/gadget","when","when/apply","poly/array"],function(a,b,c){"use strict";function d(a){var b=this;return a in b&&b[a].apply(b,n.call(arguments,1))}function e(a,c){for(var d,e=this,m=e[q],n=a?a.split("."):[],o=n.pop();m&&(d=n.shift());)switch(i.call(m)){case j:case k:if(d in m){m=m[d];break}default:m=m[d]={}}return i.call(c)===l&&(c=c.call(e,{get:function(){return f.apply(e,arguments)},has:function(){return g.apply(e,arguments)}},a)),o!==h?b(c,function(a){return m[o]=a,a}):b(c)}function f(a){for(var b,c=this[q],d=a.split(".");c&&(b=d.shift());)switch(i.call(c)){case j:case k:if(b in c){c=c[b];break}default:c=h}return c}function g(a){for(var b,c=this[q],d=a.split("."),e=d.pop();c&&(b=d.shift());)switch(i.call(c)){case j:case k:if(b in c){c=c[b];break}default:c=h}return c!==h&&e in c}var h,i=Object.prototype.toString,j="[object Array]",k="[object Object]",l="[object Function]",m="[object String]",n=Array.prototype.slice,o="length",p="adapters",q="storage",r="beforeGet",s="afterPut",t="clear",u="locks";return a.extend(function(){if(0===arguments[o])throw new Error("No adapter(s) provided");var a=this;a[p]=n.call(arguments),a[q]={},a[u]={}},{displayName:"data/store/component",lock:function(a,c,d,e){var f,g=this[u];if(i.call(a)!==m)throw new Error("key has to be of type string");return f=g[a]=b(g[a],c,d,e)},get:function(a,e,g,h){var j,k,l=this,q=n.call(arguments);for(j=0,k=q[o];k>j&&i.call(q[j])===m;j++);return e=q[j],g=q[j+1],h=q[j+2],q[o]=j,b.map(q,function(a){return b.map(l[p],function(c){return b(d.call(c,r,l,a))}).then(function(){return f.call(l,a)})}).then(e&&c(e),g,h)},put:function(a,c,f,g,h){var i=this;return b(e.call(i,a,c),function(c){return b.map(i[p],function(e){return b(d.call(e,s,i,a,c))}).yield(c)}).then(f,g,h)},putIfNotHas:function(a,c,d,e,f){var g=this;return g.has(a)?b(h,d,e,f):g.put(a,c,d,e,f)},has:function(a){return g.call(this,a)},clear:function(a,e,f){var g=this;return b.map(g[p],function(a){return b(d.call(a,t,g))}).then(a&&c(a),e,f)}})}),define("troopjs-data/cache/component",["troopjs-core/component/base"],function(a){"use strict";function b(a,i,j){var l,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H[k];if(r in a)if(a[u]=j,w=a[r],w in H){if(l=H[w],a[v]===d)return l}else l=H[w]=a;else l=a;if(i===h)for(x=0,y=a[q];y>x;x++)G=a[x],i=G===f||G===c?c:G[p],l[x]=i===g||i===h&&0!==G[q]?b.call(H,G,i,j):G;else if(i===g){if(a[v]===e)for(F in l)F===r||F===v||F===t||F in a||delete l[F];for(F in a)F===r||F===v&&l[v]===e||(G=a[F],i=G===f||G===c?c:G[p],l[F]=i===g||i===h&&0!==G[q]?b.call(H,G,i,j):G)}a:if(w!==c){if(z=0|j+(l[s]>>>0),t in l){if(A=l[t],A===z)break a;A in I&&delete I[A][w]}if(l[v]!==d)if(l[t]=z,z in I)I[z][w]=l;else if((E=I[z]={})[o]=z,E[w]=l,I[m]!==c){for(C=B=I[m];(D=C[n])!==c&&D[o]<z;C=D);C===B&&C[o]>z?(E[n]=C,I[m]=E):(E[n]=C[n],C[n]=E)}else I[m]=E}return l}var c,d=!0,e=!1,f=null,g=Object,h=Array,i=1e3,j="interval",k="generations",l="age",m="head",n="next",o="expires",p="constructor",q="length",r="id",s="maxAge",t="expires",u="indexed",v="collapsed";return a.extend(function(a){var b=this;b[l]=a||60*i,b[k]={}},{displayName:"data/cache/component","sig/start":function(){var a=this,b=a[k];a[j]=j in a?a[j]:setInterval(function(){var d,e,f=0|(new Date).getTime()/i;if(e=b[m],e!==c){do{if(e[o]>f)break;for(d in e)d!==o&&d!==n&&d!==k&&delete a[d];delete b[e[o]]}while(e=e[n]);b[m]=e}},a[l])},"sig/stop":function(){var a=this;j in a&&(clearInterval(a[j]),delete a[j])},"sig/finalize":function(){var a,b=this;for(a in b)b[a][p]===g&&r in b[a]&&delete b[a]},put:function(a){var d=this,e=a===f||a===c?c:a[p];return e===g||e===h&&0!==a[q]?b.call(d,a,e,0|(new Date).getTime()/i):a}})}),define("troopjs-data/query/component",["troopjs-core/component/base"],function(a){"use strict";var b,c=!0,d=!1,e=Object,f=Array,g="constructor",h="length",i="op",j="!",k=".",l=",",m="|",n="text",o="raw",p="resolved",q="id",r="expires",s="collapsed",t="_ast",u="_query",v=/("|')(.*?)\1/,w="$2",x=/!(.*[!,|.\s]+.*)/,y="!'$1'";return a.extend(function(a){var c=this;a!==b&&(c[u]=a)},{displayName:"data/query/component",parse:function(a){var c=this;delete c[t],a=c[u]=a||c[u]||"";var d,e,f,g,p,q,r=[];for(d=g=0,e=a[h];e>d;d++)switch(f=a.charAt(d)){case'"':case"'":p=p===f?b:f;break;case j:if(p!==b)break;q={},q[i]=f;break;case k:case l:if(p!==b)break;q!==b&&(q[o]=(q[n]=a.substring(g,d)).replace(v,w),r.push(q)),q={},q[i]=f,g=d+1;break;case m:case" ":case"	":case"\r":case"\n":if(p!==b)break;q!==b&&(q[o]=(q[n]=a.substring(g,d)).replace(v,w),r.push(q)),q=b,g=d+1}return q!==b&&(q[o]=(q[n]=a.substring(g,e)).replace(v,w),r.push(q)),c[t]=r,c},reduce:function(a){var m=this,u=0|(new Date).getTime()/1e3;t in m||m.parse();var v,w,z,A,B,C,D,E,F=m[t],G=[],H=d,I=d;for(v=0,A=F[h];A>v;v++)switch(B=F[v],B[i]){case j:D=B,C=B[o],C in a?(E=a[C],H=B[p]=E[s]!==c&&!(r in E&&E[r]<u)):(E=b,H=B[p]=d);break;case k:if(C=B[o],H)if(E&&C in E)if(E=E[C],z=E[g],z===f){for(B[p]=c,w=E[h];w-->0;)if(z=E[w],z[g]===e&&q in z&&(z[s]===c||r in z&&z[r]<u)){B[p]=d;break}}else z===e&&q in E?(B[i]=j,B[n]=(B[o]=E[q]).replace(x,y),B[p]=E[s]!==c&&!(r in E&&E[r]<u)):B[p]=c;else E=b,B[p]=d;else B[p]=d;break;case l:C=D[o],E=a[C],B[i]=j,B[n]=D[n],B[o]=C,B[p]=D[p]}for(;A-->0;)switch(B=F[A],B[i]){case j:(I||B[p]!==c)&&G.unshift(B),I=d;break;case k:G.unshift(B),I=c}return m[t]=G,m},ast:function(){var a=this;return t in a||a.parse(),a[t]},rewrite:function(){var a=this;t in a||a.parse();var b,c,d,e=a[t],f="";for(c=0,b=e[h];b>c;c++)switch(d=e[c],d[i]){case j:f+=0===c?d[n]:m+d[n];break;case k:f+=k+d[n]}return f}})}),define("troopjs-data/query/service",["module","troopjs-core/component/service","./component","troopjs-utils/merge","when","when/apply"],function(a,b,c,d,e){"use strict";var f,g=Array.prototype,h=g.slice,i=g.concat,j=g.push,k="length",l="batches",m="interval",n="cache",o="queries",p="resolved",q="configuration",r="raw",s="id",t="q",u=a.config();return b.extend(function(a){var b=this;if(a===f)throw new Error("No cache provided");b[l]=[],b[n]=a,b.configure(u)},{displayName:"data/query/service","sig/start":function(){var a=this,b=a[n];a[m]=m in a?a[m]:setInterval(function(){function c(){var b,c=[];for(b=g[k];b--;)j.apply(c,g[b][t]);return a.publish("ajax",d.call({data:{q:c.join("|")}},a[q]))}function e(a){var c,d,e,f,h;for(b.put(a),f=g[k];f--;){for(c=g[f],d=c[o],e=c[s],h=d[k];h--;)h in e&&(d[h]=b[e[h]]);c.resolve(d)}}function f(){var a,b;for(b=g[k];b--;)a=g[b],a.reject(a[o])}var g=a[l];0!==g[k]&&(a[l]=[],c().then(e,f))},200)},"sig/stop":function(){var a=this;m in a&&(clearInterval(a[m]),delete a[m])},"hub/query":function(){var a,b,d,f,m,q,u=this,v=u[l],w=u[n],x=[],y=[],z=e.defer(),A=z.resolver;try{for(m=i.apply(g,h.call(arguments)),b=0,f=m[k];f>b;b++)for(q=c(m[b]),a=q.ast(),a[k]>0&&(y[b]=a[0][r]),a=q.reduce(w).ast(),d=a[k];d-->0;)if(!a[d][p]){j.call(x,q.rewrite());break}if(0===x[k]){for(b=0;f>b;b++)b in y&&(m[b]=w[y[b]]);A.resolve(m)}else A[o]=m,A[s]=y,A[t]=x,v.push(A)}catch(B){A.reject(B)}return z.promise}})}),define("troopjs-data/component/widget",["troopjs-browser/component/widget"],function(a){"use strict";var b=Array.prototype.push;return a.extend({displayName:"data/component/widget",query:function(){var a=this,c=["query"];return b.apply(c,arguments),a.publish.apply(a,c)}})}),define("troopjs-requirejs/template",[],function(){"use strict";function a(a){function b(a,b,c){return l[m]=b?'" +'+c+'+ "':'";'+c+'o += "',"<%"+String(m++)+"%>"}function j(a,b){return l[b]}function k(a,b){return i[b]||b}var l=[],m=0;return('function template(data) { var o = "'+a.replace(c,"").replace(d,b).replace(f,k).replace(e,j)+'"; return o; }').replace(g,h)}var b={node:function(){var a=require.nodeRequire("fs");return function(b,c){var d=a.readFileSync(b,"utf8");0===d.indexOf("﻿")&&(d=d.substring(1)),c(d)}},browser:function(){var a,b,c,d=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];if("undefined"!=typeof XMLHttpRequest)b=XMLHttpRequest;else{for(c=0;3>c;c++){a=d[c];try{new ActiveXObject(a),b=function(){return new ActiveXObject(a)};break}catch(e){}}if(!b)throw new Error("XHR: XMLHttpRequest not available")}return function(a,c){var d=new b;d.open("GET",a,!0),d.onreadystatechange=function(){4===d.readyState&&c(d.responseText)},d.send(null)}},rhino:function(){var a="utf-8",b=java.lang.System.getProperty("line.separator");return function(c,d){var e,f=new java.io.File(c),g=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),a)),h=new java.lang.StringBuffer,i="";try{for(e=g.readLine(),e&&e.length()&&65279===e.charAt(0)&&(e=e.substring(1)),h.append(e);null!==(e=g.readLine());)h.append(b),h.append(e);i=String(h.toString())}finally{g.close()}d(i)}},borked:function(){return function(){throw new Error("Environment unsupported.")}}},c=/^[\n\t\r]+|[\n\t\r]+$/g,d=/<%(=)?([\S\s]*?)%>/g,e=/<%(\d+)%>/gm,f=/(["\n\t\r])/gm,g=/o \+= "";| \+ ""/gm,h="",i={'"':'\\"',"\n":"\\n","	":"\\t","\r":"\\r"},j={},k=b["undefined"!=typeof process&&process.versions&&process.versions.node?"node":"undefined"!=typeof window&&window.navigator&&window.document||"undefined"!=typeof importScripts?"browser":"undefined"!=typeof Packages?"rhino":"borked"]();return{load:function(b,c,d,e){var f=c.toUrl(b);k(f,function(g){try{g="define(function() { return "+a(g,b,f,e.template)+"; })"}catch(h){throw h.message="In "+f+", "+h.message,h}e.isBuild?j[b]=g:g+="\n//@ sourceURL='"+f+"'",d.fromText(b,g),c([b],function(a){d(a)})})},write:function(a,b,c){j.hasOwnProperty(b)&&c.asModule(a+"!"+b,j[b])}}}),define("troopjs-requirejs/multiversion",[],function(){"use strict";var a,b=/(.+?)#(.+)$/,c=/^empty:/,d=require.s.contexts;return{load:function(e,f,g){var h,i;null!==(i=b.exec(e))&&(e=i[1],h=i[2],h in d&&(f=d[h].require)),c.test(f.toUrl(e+".js"))?g(a):f([e],function(a){g(a)},g.error)}}}),define("troopjs-requirejs/shadow",["text"],function(a){"use strict";function b(a,b){for(var c,d=/([^=&]+)=([^&]+)/g,f=[],g=[];b&&(c=d.exec(b));)c[1]===e?a+=";\nreturn "+c[2]+";\n":(f.push("'"+c[2]+"'"),g.push(c[1]));return"define([ "+f.join(", ")+" ], function ("+g.join(", ")+") {\n"+a+"});"}function c(a,b){var c,d,e;for(a=a.split("."),b=b.split("."),d=Math.min(a.length,b.length),e=0;d>e;e++)if(c=parseInt(a[e],null)-parseInt(b[e],null),0!==c)return c;return a.length-b.length}var d,e="exports",f=".js",g=/(.+?)#(.+)$/,h=/^empty:/,i=require.version,j={};return{load:function(e,k,l,m){var n,o,p,q,r=e;(n=g.exec(e))&&(r=n[1],o=n[2]),q=k.toUrl(r+f),h.test(q)?l(d):a.get(q,function(a){p=b(a,o),m.isBuild&&(j[e]=p),l.fromText(e,p),c(i,"2.1.0")<0&&k([e],l)})},write:function(a,b,c){var d;b in j&&(d=j[b],c.asModule(a+"!"+b,d))}}}),define("troopjs-jquery/noconflict",["jquery"],function(a){"use strict";return a.noConflict(!0)}),define("troopjs/version",[],function(){return"2.0.2-8"}),define(["troopjs/version"],function(a){return a});